[program:warehouse-queue-worker]
process_name=%(program_name)s_%(process_num)02d
command=php /var/www/warehouse-management-system/artisan queue:work redis --sleep=3 --tries=3 --max-time=3600 --timeout=3600
autostart=true
autorestart=true
stopasgroup=true
killasgroup=true
user=www-data
numprocs=2
redirect_stderr=true
stdout_logfile=/var/www/warehouse-management-system/storage/logs/queue-worker.log
stopwaitsecs=3600
startsecs=0

; ============================================================================
; Warehouse Management System - Queue Worker Configuration
; ============================================================================
;
; INSTALLATION INSTRUCTIONS:
; 
; 1. Update the paths in this file:
;    - Replace /var/www/warehouse-management-system with your actual project path
;    - Update the user to match your web server user (www-data, nginx, apache, etc.)
;
; 2. Copy this file to supervisor configuration directory:
;    sudo cp supervisor-queue-worker.conf /etc/supervisor/conf.d/warehouse-queue-worker.conf
;
; 3. Reload supervisor configuration:
;    sudo supervisorctl reread
;    sudo supervisorctl update
;
; 4. Start the queue workers:
;    sudo supervisorctl start warehouse-queue-worker:*
;
; MANAGEMENT COMMANDS:
;
; Check status:
;    sudo supervisorctl status warehouse-queue-worker:*
;
; Restart workers (after code deployment):
;    sudo supervisorctl restart warehouse-queue-worker:*
;
; Stop workers:
;    sudo supervisorctl stop warehouse-queue-worker:*
;
; View logs:
;    tail -f /var/www/warehouse-management-system/storage/logs/queue-worker.log
;
; CONFIGURATION NOTES:
;
; - numprocs=2: Runs 2 worker processes. Adjust based on your server capacity.
; - queue:work redis: Uses Redis as queue driver. Change to 'database' if not using Redis.
; - --sleep=3: Workers sleep for 3 seconds when no jobs are available.
; - --tries=3: Jobs will be attempted 3 times before being marked as failed.
; - --max-time=3600: Workers restart after 1 hour to prevent memory leaks.
; - --timeout=3600: Maximum execution time for a single job (1 hour).
;
; PRODUCTION RECOMMENDATIONS:
;
; 1. Use Redis for better performance (already configured above)
; 2. Monitor queue-worker.log for errors
; 3. Set up alerts for failed jobs
; 4. Adjust numprocs based on queue load
; 5. Always restart workers after deploying code changes
;
; ============================================================================
